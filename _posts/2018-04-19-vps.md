---
title: "Using Google VPS, set up ssr and v2ray"
classes: wide
sitemap: true
categories:
  - Blog
tags:
  - content
  - tutorial
toc: true
toc_label: "Table of Contents"
description: Using Google cloud to build a Virtual Private Server(VPS), set up ssr and v2ray
---

# Using Google VPS, set up ssr and v2ray

## background

Virtual Private Server(VPS) is a virtual machine, google, aws, Alibaba, Tencent etc. provides their servers to customers, and  people can use these server to host there website, compute, set up proxy etc.

Here I will introduce how to set up a google VPS  and set up a network proxy server on it. For how to set up a website on VPS, refer to my postâ€”[Create your website on cloud](<https://dongdongbh.tech/resource/create-website/>).

## 1. Set up Google cloud Virtual Private Server (VPS)

1. buy a VM on [Google cloud](https://cloud.google.com/) (it has one year free trial now)
    choose Debian Linux and the place near to get fast access (eg, `asia-east`, `asia-noutheast`)
2. use ssh connect VPS (you can use browser ssh or ssh key on terminal)
    if you use terminal ssh, please set up `gcloud` first follow this [tutorial](https://cloud.google.com/compute/docs/instances/connecting-to-instance?hl=zh-cn)
    use `gcloud compute ssh [username]` to connect VPS on terminal
3. configure you VPS
4. configure you client

## 2. Set up proxy server

*Here I list two popular way to go through the special firewall, one is ssr, the other is v2ray.*

### set up BBR and ssr
set up BBR and ssr through script on VPS connected by ssh

```bash
sudo -i
wget --no-check-certificate https://github.com/iyuco/scripts/raw/master/bbr.sh
chmod +x bbr.sh
./bbr.sh
./shadowsocksR.sh
```
and if you want to create multi-user accounts, the following one is more convenient

```bash
wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/ssrmu.sh && chmod +x ssrmu.sh && bash ssrmu.sh
```

**Notice:** Don't forget set you Google cloud firewall to allow your ssr port in both http and https

### set up v2ray

Please refer the [v2ray official website](<https://www.v2ray.com/>)  for detail. For more brainless method, refer [toutyrater](<https://toutyrater.github.io/>)

or you can just run this scrip to set up it without thinking

```
bash <(curl -s -L https://git.io/v2ray.sh)
```


## 3. set up Linux PC client

### set up ssr
    ```
    wget http://www.djangoz.com/ssr
    sudo mv ssr /usr/local/bin
    sudo chmod 766 /usr/local/bin/ssr
    ssr install
    ssr config
    ```

###  Set up v2ray client

1. synchronize you time first by 

   ```
   sudo apt-get install ntp ntpdate -y
   ntpdate 0.asia.pool.ntp.org  
   sudo hwclock -w 					# write to hardware
   date # check time
   ```

   list of time server

   ```
   time.nist.gov  
   time.nuri.net  
   0.asia.pool.ntp.org  
   1.asia.pool.ntp.org  
   2.asia.pool.ntp.org  
   3.asia.pool.ntp.org
   us.pool.ntp.org 
   ```
2. download install script 

   ```bash
   wget https://install.direct/go.sh   
   ```

3. run install and set up

   ```bash
   sudo go.sh
   ```

4. move you `config.json` file to `/etc/v2ray/` and delete the default config file

5. start v2ray

   ```bash
   sudo systemctl start v2ray
   ```

6. check status

   ```bash
   service v2ray status
   ```

## 4. using socks on terminal

1. `sudo apt-get install privoxy`

2. edit /etc/privoxy/config, below is an example
    ```
    listen-address 127.0.0.1:8118   # in line 783
    forward-socks5 / 127.0.0.1:1080 .  # in line 1336
    ```

3. `sudo /etc/init.d/privoxy restart`

4. configure terminal environment by run or add following to `.bashrc`

    ```
    export http_proxy="127.0.0.1:8118"
    export https_proxy="127.0.0.1:8118"
    ```
5. try `wget http://www.google.com` to test.

### Chrome management
if you want to use chrome to manage your redirection, you can use `Proxy SwitchyOmega` extension.

## 5. set up other clients
* IOS (wingy)
* Windows ([ShadowsocksR-win](https://github.com/shadowsocksr-rm/shadowsocksr-csharp))
*  MAC ([ShadowsocksX](https://github.com/shadowsocks/ShadowsocksX-NG))
* Android([shadowsocksr-android](https://github.com/milkice233/shadowsocksr-android))

__Special statement: This tutorial is only for learning and research, thanks.__

